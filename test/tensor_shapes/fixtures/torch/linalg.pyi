# Copyright (c) Meta Platforms, Inc. and affiliates.
#
# This source code is licensed under the MIT license found in the
# LICENSE file in the root directory of this source tree.

# Type stubs for torch.linalg module (Phase 4: Advanced Linear Algebra)
from torch import Tensor

# Eigenvalue decomposition
def eig(self: Tensor) -> tuple[Tensor, Tensor]: ...
def eigh(self: Tensor, UPLO: str = "L") -> tuple[Tensor, Tensor]: ...

# Tier 3: Eigenvalues only (no eigenvectors)
def eigvals(self: Tensor) -> Tensor: ...
def eigvalsh(self: Tensor, UPLO: str = "L") -> Tensor: ...

# Cholesky decomposition
def cholesky[*Shape](input: Tensor[*Shape], upper: bool = False) -> Tensor[*Shape]: ...

# Linear system solvers
def solve(self: Tensor, other: Tensor) -> Tensor: ...
def solve_triangular(self: Tensor, other: Tensor, upper: bool = False) -> Tensor: ...
def cholesky_solve(self: Tensor, other: Tensor, upper: bool = False) -> Tensor: ...

# Matrix inverse
def inv[*Shape](input: Tensor[*Shape]) -> Tensor[*Shape]: ...

# Determinant
def det[*Batch, M, N](input: Tensor[*Batch, M, N]) -> Tensor[*Batch]: ...

# Sign and log determinant
def slogdet(self: Tensor) -> tuple[Tensor, Tensor]: ...

# Matrix power
def matrix_power[*Shape](input: Tensor[*Shape], n: int) -> Tensor[*Shape]: ...

# Matrix exponential
def matrix_exp[*Shape](input: Tensor[*Shape]) -> Tensor[*Shape]: ...

# Matrix rank
def matrix_rank[*Batch, M, N](
    input: Tensor[*Batch, M, N], tol: float = None, hermitian: bool = False
) -> Tensor[*Batch]: ...
