"use strict";(globalThis.webpackChunknew_website=globalThis.webpackChunknew_website||[]).push([[8915],{18915(e,n,t){t.r(n),t.d(n,{createRunPythonCodeFunction:()=>Y,default:()=>U,initializePyreflyWasm:()=>T});var o=t(96540),r=t(29030),s=t(8532),i=t(32855),a=t(75812),l=t(74848);function u(e,n){e(!0);const t=new Promise((e=>{setTimeout((()=>{e()}),1e3)}));return Promise.all([n(),t]).then((()=>{e(!1)}))}function x(e){let{id:n,onClick:t,defaultLabel:r,runningLabel:s,ariaLabel:i,isRunning:x,setIsRunning:c}=e;void 0!==x&&void 0!==c||([x,c]=(0,o.useState)(!1));const d=x;return(0,l.jsx)("button",{id:n,...{0:{className:"x78zum5 x6s0dn4 x1khhgft x1ypdohk x169l3ba xfo81ep xpivpjv x1vqgdyp x1aq8l9j x1v03e3n x1789zll x1com5t6 x1eqz52 x66in4q x1heor9g x1q0gjfv xxxer0w x1fh9xkg x1ru2czo"},2:{className:"x78zum5 x6s0dn4 x1khhgft x1ypdohk x169l3ba xfo81ep xpivpjv x1vqgdyp x1aq8l9j x1v03e3n x1789zll x1com5t6 x9yugl5 x1awj2ng xrynbky x1q0gjfv x1rpuqfj x4afe7t x1debuo4 x1jutyc x187oe4h x1fh9xkg x1ru2czo"},1:{className:"x78zum5 x6s0dn4 x1khhgft x169l3ba xfo81ep xpivpjv x1vqgdyp x1aq8l9j x1v03e3n x1789zll x1com5t6 x1eqz52 x66in4q x1heor9g x1q0gjfv xxxer0w x1fh9xkg x1ru2czo x1h6gzvc"},3:{className:"x78zum5 x6s0dn4 x1khhgft x169l3ba xfo81ep xpivpjv x1vqgdyp x1aq8l9j x1v03e3n x1789zll x1com5t6 x9yugl5 x1awj2ng xrynbky x1q0gjfv x1rpuqfj x4afe7t x1debuo4 x1jutyc x187oe4h x1fh9xkg x1ru2czo x1h6gzvc"}}[!!x<<1|!!d],onClick:async function(){if(!d){(0,a.R)(a.Y.CLICK,{button_id:n});try{u(c,t)}catch(e){console.error("Error in button action:",e)}}},"aria-label":i||n,disabled:d,onMouseEnter:()=>(0,a.R)(a.Y.HOVER,{button_id:n}),children:(0,l.jsx)("span",{className:"xmtou6a",children:x?s:r})})}let c=function(e){return e.NOT_INITIALIZED="not_initialized",e.INITIALIZING="initializing",e.RUNNING="running",e.FINISHED_RUNNING="finished_running",e}({});function d(e){let{runPython:n,pyodideStatus:t,setPyodideStatus:o}=e;const r=t===c.INITIALIZING||t===c.RUNNING;return(0,l.jsx)(x,{id:"run-python-button",onClick:n,defaultLabel:"\u25b6\ufe0f Run",runningLabel:"\u23f3 Running...",ariaLabel:"run Python code button",isRunning:r,setIsRunning:e=>{o(e?c.RUNNING:c.FINISHED_RUNNING)}})}var f=t(68553),p=t(32992);function m(e){let{error:n,goToDef:t}=e;const{startLineNumber:o,startColumn:s,endLineNumber:i,endColumn:a}=n;let u;u=o===i?s===a?`${o}:${s}`:`${o}:${s}-${a}`:`${o}:${s}-${i}:${a}`;const x=(0,l.jsx)("a",{href:(0,r.default)(`en/docs/error-kinds/#${n.kind}`),target:"_blank",rel:"noopener noreferrer",children:n.kind});return(0,l.jsxs)("span",{className:"x1ypdohk",onClick:()=>t(o,s,i,a),children:[2==n.severity?(0,l.jsxs)("span",{className:"x1s8ghek",children:[" ","INFO"," "]}):4==n.severity?(0,l.jsxs)("span",{className:"xburs04",children:[" ","WARN"," "]}):(0,l.jsxs)("span",{className:"x1x2k2ee",children:["ERROR"," "]}),`${n.filename}:${u}: ${n.message_header} `,"[",x,"]",n.message_details&&"\n"+n.message_details]})}function g(e){let{loading:n,goToDef:t,errors:o,internalError:r,pythonOutput:s,pyodideStatus:i,activeTab:a,setActiveTab:u=()=>{},height:x}=e;const d=a,f=null!=o&&o.length>0,p=x?{height:`${x}px`}:void 0;return(0,l.jsxs)("div",{id:"sandbox-results-container",className:"xh2ww80 x1n2onr6 xfifm61 x1eqz52 xr44f5h",style:p,children:[(0,l.jsx)("div",{className:"x78zum5 x1eqz52 xc7mbzt xif65rj",children:(0,l.jsxs)("ul",{className:"x78zum5 xe8uvvx x1ghz6dp x1717udv x67bb7w",children:[(0,l.jsx)("li",{...{0:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710"},1:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1eqz52 x16u9nvt x1jyxor1"}}[!("errors"!==d)|0],onClick:()=>u("errors"),children:"Type Checking Errors"}),(0,l.jsx)("li",{...{0:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710"},1:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1eqz52 x16u9nvt x1jyxor1"}}[!("output"!==d)|0],onClick:()=>u("output"),children:"Runtime Output"})]})}),(0,l.jsxs)("div",{className:"xysyzu8 x1io82uz",children:[n&&(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"x78zum5 xl56j7k x1anpbxc",children:[(0,l.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf xkf7kw9"}),(0,l.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf xlzs402"}),(0,l.jsx)("div",{className:"x6jxa94 x1v9usgg x18t7k3x xorixrz x1bo1o3z x1sbju2s xa4qsjk x4hg4is x1u6ievf"})]})}),!n&&"errors"===d&&(0,l.jsx)("pre",{className:"xknfcqp x1awh872 xat24cr x1eqz52 xh8yej3 x126k92a x13faqbe x1lliihq",children:(0,l.jsx)("ul",{className:"xe8uvvx x1ghz6dp x1717udv",children:f?o.filter((e=>e.severity>1)).map(((e,n)=>(0,l.jsx)("li",{...{0:{},1:{className:"x1anpbxc x889kno x19j24cx x1eqz52"}}[!!(n>0)|0],children:(0,l.jsx)(m,{error:e,goToDef:t},n)},n))):(0,l.jsx)("li",{children:r?`Pyrefly encountered an internal error: ${r}.`:null==o?"Pyrefly failed to fetch errors.":0===o?.length?"No errors!":null})})}),"output"===d&&(0,l.jsxs)("pre",{className:"xknfcqp x1awh872 xat24cr x1eqz52 xh8yej3 x126k92a x13faqbe x1lliihq",children:[(0,l.jsx)("span",{className:"x14qql8p",children:"Note: The Python runtime currently only supports features up to Python version 3.12, features from newer versions are not available. \n\n"}),i===c.NOT_INITIALIZED?"No output, please press the \u25b6\ufe0f Run button.":i===c.INITIALIZING?"Loading Python interpreter...":i===c.RUNNING?"Running...":s.trimStart()]})]})]})}var h=t(84138);const y=(e,n)=>{throw"not implemented"},b=new Map;const v=(e,n)=>null,k=new Map;const j=(e,n)=>null,z=new Map;const N=()=>[],w=new Map;const C=e=>null,S=new Map;const q={contents:()=>({tokenTypes:[],tokenModifiers:[]})};h.languages.register({id:"python",extensions:[".py"],aliases:["Python"]}),h.languages.registerCompletionItemProvider("python",{triggerCharacters:[".","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","[",'"',"'"],provideCompletionItems(e,n){try{const t=b.get(e)??y;return{suggestions:t(n.lineNumber,n.column).map((e=>({...e,insertText:e.label.toString()})))}}catch(t){return console.error(t),null}}}),h.languages.registerDefinitionProvider("python",{provideDefinition(e,n){try{const t=(k.get(e)??v)(n.lineNumber,n.column);return t&&0!==t.length?1===t.length?{uri:e.uri,range:t[0]}:t.map((n=>({uri:e.uri,range:n}))):null}catch(t){return console.error(t),null}}}),h.languages.registerHoverProvider("python",{provideHover:(e,n)=>(z.get(e)??j)(n.lineNumber,n.column)}),h.languages.registerInlayHintsProvider("python",{provideInlayHints:e=>({hints:(w.get(e)??N)(),dispose:()=>{}})}),h.languages.registerDocumentSemanticTokensProvider("python",{provideDocumentSemanticTokens:(e,n,t)=>(S.get(e)??C)(null),releaseDocumentSemanticTokens(e){},getLegend:()=>q.contents()}),h.languages.registerDocumentRangeSemanticTokensProvider("python",{provideDocumentRangeSemanticTokens:(e,n,t)=>(S.get(e)??C)(n),getLegend:()=>q.contents()}),h.editor.defineTheme("pyreflyDark",{base:"vs-dark",inherit:!0,colors:{},rules:[{token:"comment",foreground:"#6A9955",fontStyle:"italic"},{token:"keyword",foreground:"#569cd6"},{token:"operator",foreground:"#D4D4D4"},{token:"namespace",foreground:"#4EC9B0"},{token:"type",foreground:"#4EC9B0"},{token:"struct",foreground:"#4EC9B0"},{token:"class",foreground:"#4EC9B0",fontStyle:"bold"},{token:"interface",foreground:"#4EC9B0",fontStyle:"bold"},{token:"enum",foreground:"#4FC1FF",fontStyle:"bold"},{token:"typeParameter",foreground:"#4EC9B0"},{token:"function",foreground:"#DCDCAA"},{token:"member",foreground:"#DCDCAA"},{token:"macro",foreground:"#569cd6"},{token:"variable",foreground:"#9CDCFE"},{token:"variable.readonly",foreground:"#4EC9B0"},{token:"parameter",foreground:"#9CDCFE"},{token:"property",foreground:"#9CDCFE"},{token:"label",foreground:"#C8C8C8"},{token:"type.static",fontStyle:"bold"},{token:"class.static",foreground:"#ff0000",fontStyle:"bold"}]}),h.editor.defineTheme("pyreflyLight",{base:"vs",inherit:!0,colors:{},rules:[{token:"comment",foreground:"#008000",fontStyle:"italic"},{token:"keyword",foreground:"#0000ff"},{token:"operator",foreground:"#000000"},{token:"namespace",foreground:"#267f99"},{token:"type",foreground:"#267f99"},{token:"struct",foreground:"#267f99"},{token:"class",foreground:"#267f99",fontStyle:"bold"},{token:"interface",foreground:"#267f99",fontStyle:"bold"},{token:"enum",foreground:"#0070C1",fontStyle:"bold"},{token:"typeParameter",foreground:"#267f99"},{token:"function",foreground:"#795E26"},{token:"member",foreground:"#795E26"},{token:"macro",foreground:"#615a60"},{token:"variable",foreground:"#001080"},{token:"variable.readonly",foreground:"#267f99"},{token:"parameter",foreground:"#001080"},{token:"property",foreground:"#001080"},{token:"label",foreground:"#000000"},{token:"type.static",fontStyle:"bold"},{token:"class.static",foreground:"#ff0000",fontStyle:"bold"}]}),f.wG.config({monaco:h});const I="\n# Welcome to the Pyrefly Sandbox, this is a page\n# where you can write, share and learn about typing in Python.\n#\n# Here are a couple features of this sandbox:\n# - Get real-time type checking feedback\n# - Use reveal_type() to inspect inferred types\n# - experiment with the IDE features that we support (e.g. autocomplete, go-to-definition, hover, etc)\n# - Write and run Python code directly in your browser\n\nfrom typing import *\nfrom utils import format_number\n\ndef test(x: int):\n    return format_number(x)\n\n# reveal_type will produce a type error that tells you the type Pyrefly has\n# computed for the return (in this case, str)\nreveal_type(test(42))\n".trimStart(),E='\n# Utility functions\n\ndef format_number(x: int) -> str:\n    return f"Number: {x}"\n'.trimStart();let L=null,P=null,R=null;const M=async e=>{if(L&&R)return R(""),new Promise((n=>{P=n,L?.postMessage(e)}));console.error("Python worker not initialized. Call initializePythonWorker first.")},$=async(e,n)=>{if(L&&R)return R(""),new Promise((t=>{P=t;const o={activeFile:e,allFiles:n};L?.postMessage(o)}));console.error("Python worker not initialized. Call initializePythonWorker first.")},D=e=>{let{setPythonOutput:n,setPyodideStatus:r}=e;return(0,o.useEffect)((()=>(null===L&&((e,n)=>{if(null!==L)return;R=e;const o=new Worker(new URL(t.p+t.u(8123),t.b),{type:void 0});o.onmessage=t=>{const o=t.data;switch(o.type){case"stdout":case"stderr":return void e((e=>e+"\n"+o.output));case"pyodideStatusUpdate":return void n(o.status);case"runPython":return!o.success&&o.error&&e((e=>e+"\n"+`Error: ${o.error}`)),void(P&&(P(),P=null));default:console.error(`Unknown message type received from worker: ${o}`)}},L=o})(n,r),()=>{})),[n,r]),{runPython:M,runMultiFilePython:$}};async function T(){const e="undefined"!=typeof window?t.e(3190).then(t.bind(t,93190)):new Promise((e=>{}));try{const n=await e;return await n.default(),await n}catch(n){throw console.error(n),n}}let F=null;function U(e){let{sampleFilename:n,isCodeSnippet:t=!1,codeSample:r=I,isInViewport:s=!0}=e;const a=(0,o.useRef)(null),x=(0,o.useRef)(null),[d,f]=(0,o.useState)([]),[m,y]=(0,o.useState)(""),[v,j]=(0,o.useState)(!0),[N,C]=(0,o.useState)(null),[L,P]=(0,o.useState)(null),[R,M]=(0,o.useState)(new Map),[$,U]=(0,o.useState)("sandbox.py"),[B,X]=(0,o.useState)(null),[ee,ne]=(0,o.useState)(""),[te,oe]=(0,o.useState)(c.NOT_INITIALIZED),[re,se]=(0,o.useState)(""),[ie,ae]=(0,o.useState)("errors"),[le,ue]=(0,o.useState)(!1),[xe,ce]=(0,o.useState)("3.12"),[de,fe]=(0,o.useState)(null),[pe,me]=(0,o.useState)(!1),ge=R.get($)||null,he=(0,o.useCallback)((function(e,n){void 0===n&&(n="");const t=h.editor.getModels().find((n=>n.uri.path===`/${e}`));let o;if(t)t.setValue(n),o=t;else{const t=e.endsWith(".toml")?"toml":"python";o=h.editor.createModel(n,t,h.Uri.file(`/${e}`))}M((n=>new Map(n).set(e,o))),U(e)}),[]),ye=(0,o.useCallback)((e=>{if(R.has(e)){U(e);const n=a.current,t=R.get(e);n&&t&&n.setModel(t),N&&N.setActiveFile(e)}}),[R,N]),be=(0,o.useCallback)((()=>{if(B)return;let e=1,n="untitled.py";for(;R.has(n);)n=`untitled${e}.py`,e++;he(n,""),X(n),ne("")}),[R,he,B]),ve=(0,o.useCallback)(((e,n)=>{if(!n.trim()||R.has(n))return!1;let t;const o=n.trim();if("pyrefly.toml"===o||o.endsWith("/pyrefly.toml"))t="pyrefly.toml";else{if(!o.endsWith(".py")&&!o.endsWith(".pyi"))return!1;t=o}if(R.has(t))return!1;const r=R.get(e);if(!r)return!1;const s=t.endsWith(".toml")?"toml":"python",i=h.editor.createModel(r.getValue(),s,h.Uri.file(`/${t}`)),l=a.current;return $===e&&l&&l.setModel(i),M((n=>{const o=new Map(n);return o.delete(e),o.set(t,i),o})),$===e&&U(t),setTimeout((()=>{r.dispose()}),100),!0}),[R,$]),ke=(0,o.useCallback)(((e,n)=>{if(!e.trim())return!1;const t=e.trim();return!(!t.endsWith(".py")&&!t.endsWith(".pyi")&&"pyrefly.toml"!==t)&&(t===n||!R.has(t))}),[R]),je=(0,o.useCallback)((()=>{if(!B)return;if(!ke(ee,B))return;ve(B,ee.trim())&&(X(null),ne(""))}),[B,ee,ve,ke]),ze=(0,o.useCallback)((e=>{if("sandbox.py"===e)return!1;const n=R.get(e);if(!n)return!1;if(M((n=>{const t=new Map(n);return t.delete(e),t})),$===e){U("sandbox.py");const e=a.current,n=R.get("sandbox.py");e&&n&&e.setModel(n)}return B===e&&(X(null),ne("")),setTimeout((()=>{n.dispose()}),100),!0}),[R,$,B]),Ne=(0,o.useCallback)((e=>{e.preventDefault(),me(!0)}),[]);(0,o.useLayoutEffect)((()=>{if(t)return;const e=x.current;if(e&&null===de){const n=e.clientHeight;n>0&&fe(.75*n)}})),(0,o.useEffect)((()=>{if(t)return;const e=x.current;if(!e)return;const n=new ResizeObserver((e=>{if(!pe)for(const n of e){const e=n.contentRect.height;if(e>0&&null!==de){const n=e-120-6,t=Math.max(100,Math.min(de,n));t!==de&&fe(t)}}}));return n.observe(e),()=>n.disconnect()}),[t,pe,de]),(0,o.useEffect)((()=>{if(!pe)return;const e=e=>{const n=x.current;if(!n)return;const t=n.getBoundingClientRect(),o=t.top,r=t.height,s=e.clientY-o,i=r-120-6,a=Math.max(100,Math.min(s,i));fe(a)},n=()=>{me(!1)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",n),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)}}),[pe]);const we=()=>(0,l.jsxs)("div",{className:"x78zum5 x1eqz52 xc7mbzt xif65rj xejiqos xjblrfn x6s0dn4",children:[Array.from(R.keys()).map((e=>(0,l.jsx)("div",{className:"x78zum5 x6s0dn4",children:B===e?(0,l.jsxs)("div",{...{0:{className:"x78zum5 x6s0dn4 xdqdrvq x18t7k3x x1e13svl x18zih8k x10d6zji"},1:{className:"x78zum5 x6s0dn4 xdqdrvq x18t7k3x x1e13svl x18zih8k x10d6zji xkuhdyg"}}[!ke(ee,e)|0],children:[(0,l.jsx)("input",{className:"x1gs6z28 x1md70p1 xiuzu7u xif65rj x117nqv4 x1a2a7pz x6c5l4p x16q51m2",value:ee,onChange:e=>ne(e.target.value),onKeyDown:e=>{"Enter"===e.key||e.ctrlKey&&"s"===e.key?(e.preventDefault(),je()):"Escape"===e.key&&(X(null),ne(""))},onBlur:je,placeholder:"Enter filename",autoFocus:!0}),(0,l.jsx)("span",{className:"xv1l7n4 xif65rj x117nqv4 x1swdo50"})]}):(0,l.jsx)("button",{onClick:()=>ye(e),...{0:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1gs6z28 xjbqb8w xiuzu7u xif65rj xahlotz"},1:{className:"x1tc92mu x1ypdohk x117nqv4 x7pa710 x1gs6z28 xiuzu7u xif65rj xahlotz x1eqz52 x16u9nvt x1jyxor1"}}[!(e!==$)|0],children:e})},e))),(0,l.jsxs)("div",{className:"x78zum5 x6s0dn4 x1jnr06f xet2fuk",children:[(0,l.jsx)("button",{onClick:()=>ze($),...{0:{className:"x1gs6z28 x1md70p1 xiuzu7u x1ypdohk x2lkgqm x117nqv4 x12oqio5 x46jg8d x78zum5 x6s0dn4 xl56j7k x15otokf xosj86m xnj1at0"},1:{className:"x1gs6z28 x1md70p1 xiuzu7u x2lkgqm x117nqv4 x12oqio5 x46jg8d x78zum5 x6s0dn4 xl56j7k xosj86m xti2d7y x1h6gzvc x1n5bzlp x8joddd"}}[!("sandbox.py"!==$)|0],title:"sandbox.py"===$?"Cannot delete sandbox.py":B?"Cancel":"Delete file",disabled:"sandbox.py"===$,onMouseDown:e=>{e.preventDefault()},children:"\xd7"}),B?(0,l.jsx)("button",{onClick:je,...{0:{className:"x1gs6z28 x1md70p1 xiuzu7u x1ypdohk x2lkgqm x1j61zf2 x117nqv4 x12oqio5 x46jg8d x78zum5 x6s0dn4 xl56j7k x15otokf x12602er"},1:{className:"x1gs6z28 x1md70p1 xiuzu7u x2lkgqm x1j61zf2 x117nqv4 x12oqio5 x46jg8d x78zum5 x6s0dn4 xl56j7k xti2d7y x1h6gzvc x1n5bzlp x8joddd"}}[!ke(ee,B)|0],title:ke(ee,B)?"Save file name":"Invalid filename",disabled:!ke(ee,B),children:"\u2713"}):(0,l.jsx)("button",{onClick:be,className:"x1gs6z28 x1md70p1 xiuzu7u x1ypdohk x2lkgqm x1j61zf2 x117nqv4 x12oqio5 x46jg8d x78zum5 x6s0dn4 xl56j7k x15otokf",title:"Add new file",children:"+"})]})]});function Ce(e){if(R.size>0&&N&&ge){const n={};if(R.forEach(((e,t)=>{n[t]=e.getValue()})),Object.keys(n).length>0){const t=N.updateSandboxFiles(n,e);t&&ce(t),N.setActiveFile($)}return!0}return!1}function Se(){if(null!=ge&&null!=N){var e;!function(e,n){b.set(e,n)}(ge,((e,n)=>N.autoComplete(e,n))),function(e,n){k.set(e,n)}(ge,((e,n)=>N.gotoDefinition(e,n))),function(e,n){z.set(e,n)}(ge,((e,n)=>N.hover(e,n))),function(e,n){w.set(e,n)}(ge,(()=>N?.inlayHint()||[])),function(e,n){S.set(e,n)}(ge,(e=>N?.semanticTokens(e))),e=()=>N?.semanticTokensLegend()??{tokenTypes:[],tokenModifiers:[]},q.contents=e;try{if("pyrefly.toml"===$)Ce(!1),N.setActiveFile($);else if(R.size>1){const e=ge.getValue();N.updateSingleFile($,e),N.setActiveFile($)}else{const e=ge.getValue();N.updateSingleFile($,e)}const e=N.getErrors();R.forEach((e=>{h.editor.setModelMarkers(e,"default",[])}));const n=new Map;e.forEach((e=>{const t=e.filename||$;n.has(t)||n.set(t,[]),n.get(t).push(e)})),n.forEach(((e,n)=>{const t=R.get(n);t&&h.editor.setModelMarkers(t,"default",function(e){return e.map((e=>{const n=e.message_details?`${e.message_header}\n${e.message_details}`:e.message_header;return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn,message:n,severity:e.severity}}))}(e))})),y(""),f(e)}catch(n){console.error(n),y(JSON.stringify(n)),f([])}}}(0,o.useEffect)((()=>{if(0===R.size){let e;const o=function(){if("undefined"==typeof window)return null;return new URLSearchParams(window.location.search).get("version")}();o?(ce(o),e=o):e=xe;const s=function(e,n,t,o){const r=function(){if("undefined"==typeof window)return null;const e=new URLSearchParams(window.location.search),n=e.get("project");if(n)try{const e=p.decompressFromEncodedURIComponent(n);return e?JSON.parse(e):null}catch(o){console.error("Failed to parse project from URL:",o)}const t=e.get("code");if(t){const e=p.decompressFromEncodedURIComponent(t);if(e)return{files:{"sandbox.py":e},activeFile:"sandbox.py"}}return null}();if(!r)return!1;h.editor.getModels().forEach((e=>e.dispose())),t(new Map),Object.entries(r.files).forEach((n=>{let[t,o]=n;e(t,o)})),r.files["pyrefly.toml"]||e("pyrefly.toml",O(o));r.activeFile&&r.files[r.activeFile]&&n(r.activeFile);return!0}(he,U,M,e);s||(t?(he(n,r),U(n)):(he("sandbox.py",I),he("utils.py",E),he("pyrefly.toml",O(e)),U("sandbox.py")))}}),[he,R.size,t,n,r]),(0,o.useEffect)((()=>{s&&(j(!0),F||(F=T()),F.then((e=>{try{C(new e.State(xe)),j(!1),y("")}catch(n){j(!1),y(`Failed to initialize with Python ${xe}: ${n}`)}})).catch((e=>{j(!1),y(JSON.stringify(e))})))}),[s,xe]),h.editor.onDidCreateModel((e=>{const n=_($);n&&M((e=>new Map(e).set($,n)))})),(0,o.useEffect)((()=>{const e=a.current,n=R.get($);e&&n&&e.getModel()!==n&&e.setModel(n)}),[$,R]),(0,o.useEffect)((()=>{Se()}),[N,ge]),(0,o.useEffect)((()=>{Ce(!0)&&setTimeout((()=>Se()),100)}),[R.size,N,ge,$]);const{runPython:qe,runMultiFilePython:Ie}=D({setPythonOutput:se,setPyodideStatus:oe}),Ee=Y(ae,qe,Ie,R,$),Le=(0,o.useCallback)((async()=>{ge&&(oe(c.RUNNING),await Ee(ge))}),[ge,ae,oe]);const Pe=function(e,n,t,r,s,i,a,u,x,c,d,f){let p=[];p=e?[(0,l.jsx)(W,{model:n}),K(n),A()?null:J(n,i,a,e,x,c,d,f)].filter(Boolean):[Z(t,r,s),G(x,c),J(n,i,a,e,x,c,d,f),H(x,c,u)];return p.map(((n,t)=>o.cloneElement(n,{key:`button-${t}`,...!e&&A()?{className:{className:"x1i06gni x1i8vjtc"}}:{}})))}(t,ge,Le,te,oe,Se,r,xe,R,$,he,U);return(0,l.jsxs)("div",{id:"sandbox-editor",...{0:{className:"x78zum5 xdt5ytf x98rzlu x1dr59a3 x1bwycvy xb3r6kr"},1:{className:"x78zum5 xdt5ytf x98rzlu x1dr59a3 x1bwycvy xb3r6kr x1awh872"}}[!(t||A())|0],children:[!t&&(0,l.jsx)(we,{}),(0,l.jsxs)("div",{ref:x,...{0:{className:"x78zum5 xdt5ytf x98rzlu x2lwn1j xb3r6kr"},1:{className:"x78zum5 xdt5ytf x98rzlu x2lwn1j xb3r6kr x87ps6o"}}[!!pe|0],children:[(0,l.jsxs)("div",{id:"sandbox-code-editor-container",...{0:{className:"x1n2onr6 x78zum5 x1rea2x4 x7hct1x x1eqz52 x5yr21d"},2:{className:"x1n2onr6 x78zum5 x1rea2x4 x7hct1x x1eqz52 x5yr21d x66in4q x16eypsj"},1:{className:"x1n2onr6 x78zum5 x1rea2x4 x7hct1x x1eqz52 x5yr21d x1ci220x x76ihet x1olqv08 xhbaxng x1iorvi4"},3:{className:"x1n2onr6 x78zum5 x1rea2x4 x7hct1x x1eqz52 x5yr21d x16eypsj x1ci220x x76ihet x1olqv08 xhbaxng x1iorvi4"}}[!!t<<1|!t],onMouseEnter:()=>ue(!0),onMouseLeave:()=>ue(!1),children:[V(t,$,ge?.getValue()||r,Se,(function(e){const n=_($);if(n&&M((e=>new Map(e).set($,n))),t){const n=A()?45:0;P(Math.max(50,e.getContentHeight()+n))}a.current=e,e.addCommand(h.KeyMod.CtrlCmd|h.KeyCode.Enter,(()=>{if(!t&&te!==c.INITIALIZING&&te!==c.RUNNING){const n=e.getModel();n&&u((e=>oe(e?c.RUNNING:c.FINISHED_RUNNING)),(async()=>{await Ee(n)}))}}))}),(()=>{if(t)return L;if(null!==de)return de;const e=window.innerHeight,n=document.querySelector(".navbar");return 75*(e-(n?.offsetHeight||0))/100})(),$,R),(0,l.jsx)("div",{...i.xk(Q.buttonContainerBase,A()?t?Q.mobileButtonContainerCodeSnippet:Q.mobileButtonContainerSandbox:Q.desktopButtonContainer,!t||le||A()?Q.visibleButtonContainer:Q.hiddenButtonContainer),children:Pe})]}),!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{...{0:{className:"xols6we x7a0b8v xyozgr7 x2lah0s xmdmsmi xl80g4i"},1:{className:"xols6we xyozgr7 x2lah0s xmdmsmi xl80g4i x15dlep9"}}[!!pe|0],onMouseDown:Ne}),(0,l.jsx)(g,{loading:v,goToDef:(e,n,t,o)=>{const r=a.current;if(null===r)return;const s={startLineNumber:e,startColumn:n,endLineNumber:t,endColumn:o};r.revealRange(s),r.setSelection(s)},errors:d,internalError:m,pythonOutput:re,pyodideStatus:te,activeTab:ie,setActiveTab:ae,height:(()=>{const e=x.current;if(e&&null!==de)return e.clientHeight-de})()})]})]})]})}function B(e,n){const t={files:e,activeFile:n},o=p.compressToEncodedURIComponent(JSON.stringify(t)),r=new URLSearchParams;r.set("project",o);const s=`${window.location.pathname}?${r.toString()}`;window.history.replaceState({},"",s)}function _(e){const n=h.editor.getModels().filter((n=>n?.uri?.path===`/${e}`))[0];return null==n?null:(n.setValue(n.getValue()),n.updateOptions({tabSize:4,insertSpaces:!0}),n)}function O(e){return["# Pyrefly sandbox configuration.","# See https://pyrefly.org/en/docs/configuration/ for available configuration options.",`python-version = "${e}"`,""].join("\n")}function A(){return/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)}function V(e,n,t,o,r,i,a,u){const{colorMode:x}=s.G(),c="dark"===x?"pyreflyDark":"pyreflyLight";return e?(0,l.jsx)(f.Ay,{defaultPath:n,defaultValue:t,defaultLanguage:"python",theme:c,onChange:o,onMount:r,keepCurrentModel:!0,height:i,options:{readOnly:A(),domReadOnly:A(),minimap:{enabled:!1},hover:{enabled:!0,above:!1},scrollBeyondLastLine:!1,overviewRulerBorder:!1,"semanticHighlighting.enabled":!0}}):(0,l.jsx)(f.Ay,{defaultPath:n,defaultValue:t,defaultLanguage:"python",theme:c,onChange:o,onMount:r,keepCurrentModel:!0,height:i,options:{readOnly:!1,domReadOnly:!1,minimap:{enabled:!1},hover:{enabled:!0,above:!1},scrollBeyondLastLine:!1,overviewRulerBorder:!1,"semanticHighlighting.enabled":!0}})}function G(e,n){return(0,l.jsx)(x,{id:"share-url-button",onClick:()=>{const t={};e.forEach(((e,n)=>{t[n]=e.getValue()})),B(t,n);const o=window.location.href;return navigator.clipboard.writeText(o)},defaultLabel:"\ud83d\udccb Share URL",runningLabel:"\u2713 URL Copied!",ariaLabel:"share URL button"})}function H(e,n,t){return(0,l.jsx)(x,{id:"github-issues-button",onClick:()=>{const o={};e.forEach(((e,n)=>{o[n]=e.getValue()})),B(o,n);const r=window.location.href,s=e.get(n),i=["```python",s?s.getValue():"","```","",`Python: ${t}`,"","\x3c!-- Describe your bug --\x3e"].join("\n"),a=`https://github.com/facebook/pyrefly/issues/new?template=issue_template.yml&labels=bug&title=${encodeURIComponent("Bug Report")}&sandbox=${encodeURIComponent(r)}`,l=a+`&description=${encodeURIComponent(i)}`;if(l.length<=1800)return window.open(l,"_blank","noopener,noreferrer"),Promise.resolve();{const e=a+`&description=${encodeURIComponent("\x3c!-- Code is too long to include here. Please paste the smallest reproducible snippet (\u226430 lines), include your Python version, and briefly describe expected vs actual behavior. --\x3e")}`;return window.open(e,"_blank","noopener,noreferrer"),Promise.resolve()}},defaultLabel:"\u26a0\ufe0f Report Issue",runningLabel:"\u26a0\ufe0f Report Issue",ariaLabel:"report issue on GitHub"})}function W(e){let{model:n}=e;const t=(0,r.default)("sandbox/");return(0,l.jsx)(x,{id:"open-sandbox-button",onClick:async()=>{if(n){const e=n.getValue(),o=p.compressToEncodedURIComponent(e),r=t+`?code=${o}`;window.location.href=r}return Promise.resolve()},defaultLabel:"\ud83e\uddea Open in Sandbox",runningLabel:"\u23f3 Opening Sandbox...",ariaLabel:"open in sandbox"})}function Z(e,n,t){return(0,l.jsx)(d,{runPython:e,pyodideStatus:n,setPyodideStatus:t})}function K(e){return(0,l.jsx)(x,{id:"copy-code-button",onClick:async()=>{if(e){const n=e.getValue();await navigator.clipboard.writeText(n)}return Promise.resolve()},defaultLabel:"\ud83d\udccb Copy",runningLabel:"\u2713 Copied!",ariaLabel:"copy code to clipboard"})}function J(e,n,t,o,r,s,i,a){return(0,l.jsx)(x,{id:"reset-button",onClick:async()=>{o||(i("utils.py",E),a("sandbox.py"),n()),e&&(e.setValue(t),n())},defaultLabel:"\ud83d\udd04 Reset",runningLabel:"\u2713 Reset!",ariaLabel:"reset to default code"})}function Y(e,n,t,o,r){return async s=>{if(s)if(e("output"),o.size>1){const e={};o.forEach(((n,t)=>{e[t]=n.getValue()})),await t(r,e)}else{const e=s.getValue();await n(e)}}}const Q={buttonContainerBase:{position:"x10l6tqk",display:"x78zum5",zIndex:"x1n327nk",gap:"x167g77z",rowGap:null,columnGap:null,$$css:!0},mobileButtonContainerCodeSnippet:{bottom:"x191j7n5",right:"xn5hqff",insetInlineStart:null,insetInlineEnd:null,$$css:!0},mobileButtonContainerSandbox:{bottom:"x191j7n5",right:"xn5hqff",insetInlineStart:null,insetInlineEnd:null,flexDirection:"xdt5ytf",$$css:!0},desktopButtonContainer:{top:"xmhk92p",right:"xk6ci0l",insetInlineStart:null,insetInlineEnd:null,$$css:!0},hiddenButtonContainer:{opacity:"xg01cxk",visibility:"xlshs6z",transition:"x17ce4s4",transitionBehavior:null,transitionDelay:null,transitionDuration:null,transitionProperty:null,transitionTimingFunction:null,$$css:!0},visibleButtonContainer:{opacity:"x1hc1fzr",visibility:"xnpuxes",transition:"x17ce4s4",transitionBehavior:null,transitionDelay:null,transitionDuration:null,transitionProperty:null,transitionTimingFunction:null,$$css:!0}}},75812(e,n,t){t.d(n,{R:()=>r,Y:()=>o});let o=function(e){return e.CLICK="click",e.HOVER="hover",e}({});function r(e,n){"undefined"!=typeof window&&window.gtag&&window.gtag("event",e,n)}}}]);