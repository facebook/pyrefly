"use strict";(self.webpackChunknew_website=self.webpackChunknew_website||[]).push([[7711],{27711:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>p});const s=JSON.parse('{"id":"error-suppressions","title":"Pyrefly Error Suppressions","description":"Learn how to suppress type check errors in Pyrefly with code comments and baseline files.","source":"@site/docs/error-suppressions.mdx","sourceDirName":".","slug":"/error-suppressions","permalink":"/en/docs/error-suppressions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/pyrefly/edit/main/website/docs/error-suppressions.mdx","tags":[],"version":"current","frontMatter":{"title":"Pyrefly Error Suppressions","description":"Learn how to suppress type check errors in Pyrefly with code comments and baseline files."},"sidebar":"docsSidebar","previous":{"title":"Django Support","permalink":"/en/docs/django"},"next":{"title":"Error Kinds","permalink":"/en/docs/error-kinds"}}');var t=n(74848),o=n(28453),i=n(31888);const l={title:"Pyrefly Error Suppressions",description:"Learn how to suppress type check errors in Pyrefly with code comments and baseline files."},a=void 0,c={},p=[{value:"Error Suppression Comments",id:"error-suppression-comments",level:2},{value:"Baseline Files (Experimental)",id:"baseline-files-experimental",level:2},{value:"Upgrading Pyrefly (And other changes that introduce new type errors)",id:"upgrading-pyrefly-and-other-changes-that-introduce-new-type-errors",level:2}];function d(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:["\n","\n",(0,t.jsx)(r.h2,{id:"error-suppression-comments",children:"Error Suppression Comments"}),"\n",(0,t.jsx)(r.p,{children:"The Python type system allows you to suppress errors with a comment. This feature can be helpful in many scenarios. For example, after enabling a type checker, suppressions can allow you to get a clean type check signal without having to stop and fix every pre-existing error in your code."}),"\n",(0,t.jsx)(r.p,{children:"There are multiple ways to do this in Pyrefly."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'def foo() -> int:\n  # pyrefly: ignore\n  return "this is a type error"\n'})}),"\n",(0,t.jsx)(r.p,{children:"You can also put the comment on the same line as the error."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'def foo() -> int:\n  return "this is a type error" # pyrefly: ignore\n'})}),"\n",(0,t.jsx)(r.p,{children:"You can also target specific error types:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'def foo() -> int:\n  return "this is a type error" # pyrefly: ignore[bad-return]\n'})}),"\n",(0,t.jsxs)(r.p,{children:["We respect the specification and allow ",(0,t.jsx)(r.code,{children:"type: ignore"})," to be used:"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-python",children:'def foo() -> int:\n  return "this is a type error" # type: ignore\n'})}),"\n",(0,t.jsx)(r.p,{children:"We also have a special comment that will ignore all errors in a file."}),"\n",(0,t.jsx)("pre",{children:(0,t.jsx)(i.A,{sampleFilename:"why_hints.py",isCodeSnippet:!0,codeSample:'# pyrefly: ignore-errors\n\nfrom typing import *\n\ndef test(x: int):\n  return f"{x}"\n\ndef bar() -> int:\n  # this error won\'t be reported\n  return ""\n'})}),"\n",(0,t.jsx)(r.p,{children:"Pyrefly can automatically suppress all type errors in your project by running:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"pyrefly suppress\n"})}),"\n",(0,t.jsxs)(r.p,{children:["This is equivalent to ",(0,t.jsx)(r.code,{children:"pyrefly check --suppress-errors"}),"."]}),"\n",(0,t.jsx)(r.h2,{id:"baseline-files-experimental",children:"Baseline Files (Experimental)"}),"\n",(0,t.jsxs)(r.p,{children:["Pyrefly also supports storing errors in a baseline file. Any errors matching the baseline will be ignored and only new errors will be reported.\nThis is useful when introducing type checking to a project for the first time, or when rolling out changes that require many suppression comments.\nThis feature is inspired by tools like ",(0,t.jsx)(r.a,{href:"https://docs.basedpyright.com/latest/benefits-over-pyright/baseline/",children:"basedpyright"})," and ",(0,t.jsx)(r.a,{href:"https://developer.android.com/studio/write/lint#snapshot",children:"Android Studio"}),"."]}),"\n",(0,t.jsx)(r.p,{children:"To generate (or re-generate) the baseline file:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'pyrefly check --baseline="<path to baseline file>" --update-baseline\n'})}),"\n",(0,t.jsx)(r.p,{children:"To check your project using a baseline file and report only newly-introduced errors, you can either use the CLI flag:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:'pyrefly check --baseline="<path to baseline file>"\n'})}),"\n",(0,t.jsxs)(r.p,{children:["Or specify the baseline in your configuration file (",(0,t.jsx)(r.code,{children:"pyrefly.toml"})," or ",(0,t.jsx)(r.code,{children:"pyproject.toml"}),"):"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-toml",children:'# pyrefly.toml\nbaseline = "baseline.json"\n'})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-toml",children:'# pyproject.toml\n[tool.pyrefly]\nbaseline = "baseline.json"\n'})}),"\n",(0,t.jsxs)(r.p,{children:["When the baseline is specified in the configuration file, you don't need to pass the ",(0,t.jsx)(r.code,{children:"--baseline"})," flag on every invocation. The CLI flag takes precedence if both are specified."]}),"\n",(0,t.jsxs)(r.p,{children:["Note that ",(0,t.jsx)(r.code,{children:"baseline"})," is a ",(0,t.jsx)(r.strong,{children:"project-level setting"})," and cannot be overridden in ",(0,t.jsx)(r.a,{href:"/en/docs/configuration#sub-configs",children:(0,t.jsx)(r.code,{children:"sub-config"})})," sections. If you need different baseline files for different parts of your codebase, consider using separate Pyrefly configuration files."]}),"\n",(0,t.jsx)(r.p,{children:"Errors are matched with the baseline by looking at file, error code, and column number.\nNote that errors suppressed by the baseline file are still shown in the IDE.\nThis feature is experimental, so please submit any feedback or requests you have on our Github repo."}),"\n",(0,t.jsx)(r.h2,{id:"upgrading-pyrefly-and-other-changes-that-introduce-new-type-errors",children:"Upgrading Pyrefly (And other changes that introduce new type errors)"}),"\n",(0,t.jsx)(r.p,{children:"Upgrading the version of Pyrefly you're using, or a third party library you depend on can surface new type errors in your code. Fixing them all at once is often not realistic. We've written scripts to help you temporarily silence them."}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# step 1\npyrefly suppress\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# step 2\n<run your formatter of choice>\n"})}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{children:"# step 3\npyrefly suppress --remove-unused\n"})}),"\n",(0,t.jsx)(r.p,{children:"Repeat the steps above until you get a clean formatting run and a clean type check."}),"\n",(0,t.jsxs)(r.p,{children:["This will add ",(0,t.jsx)(r.code,{children:" # pyrefly: ignore"})," comments to your code that will enable you to silence errors, and come back and fix them at a later date. This can make the process of upgrading a large codebase much more manageable."]}),"\n",(0,t.jsx)(r.admonition,{type:"note",children:(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"pyrefly suppress"})," is equivalent to ",(0,t.jsx)(r.code,{children:"pyrefly check --suppress-errors"}),", and ",(0,t.jsx)(r.code,{children:"pyrefly suppress --remove-unused"})," is equivalent to ",(0,t.jsx)(r.code,{children:"pyrefly check --remove-unused-ignores"}),"."]})})]})}function h(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,r,n)=>{n.d(r,{R:()=>i,x:()=>l});var s=n(96540);const t={},o=s.createContext(t);function i(e){const r=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function l(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:r},e.children)}},31888:(e,r,n)=>{n.d(r,{A:()=>l});var s=n(35363),t=n(96540),o=(n(32855),n(74848));const i=t.lazy((()=>Promise.all([n.e(1869),n.e(8285),n.e(8915)]).then(n.bind(n,18915))));function l(e){let{sampleFilename:r,codeSample:n=""}=e;if(null==r)throw"Missing sampleFilename. IDE services won't work properly.";const[l,a]=t.useState(!1),[c,p]=t.useState(!1),d=t.useRef(null);return t.useEffect((()=>{if("undefined"==typeof window)return;if(!d.current)return;const e=new IntersectionObserver((e=>{const r=e[0];a(r.isIntersecting),r.isIntersecting&&p(!0)}),{rootMargin:"500px 0px",threshold:.1});return e.observe(d.current),()=>e.disconnect()}),[]),(0,o.jsxs)("div",{ref:d,className:"x1717udv x1ghz6dp",children:[!c&&(0,o.jsx)("div",{className:"xh8yej3 x5yr21d x126k92a xysyzu8 x1tamke2 x1ybsatz x1sp1r08",children:(0,o.jsx)("div",{className:"xb3r6kr x1n2onr6 xif65rj x1iwq0vh",children:n})}),c&&(0,o.jsx)("pre",{className:"xqid1ag x1rea2x4 x1n2onr6 x7ywyr2",children:(0,o.jsx)(s.A,{children:()=>(0,o.jsx)(t.Suspense,{fallback:(0,o.jsx)("div",{children:"Loading..."}),children:(0,o.jsx)(i,{sampleFilename:r,isCodeSnippet:!0,codeSample:n,isInViewport:l})})})})]})}},32855:(e,r,n)=>{n.d(r,{xk:()=>a});var s,t={};var o=function(){if(s)return t;s=1,Object.defineProperty(t,"__esModule",{value:!0}),t.styleq=void 0;var e=new WeakMap;function r(r){var n,s,t;return null!=r&&(n=!0===r.disableCache,s=!0===r.disableMix,t=r.transform),function(){for(var r=[],o="",i=null,l="",a=n?null:e,c=new Array(arguments.length),p=0;p<arguments.length;p++)c[p]=arguments[p];for(;c.length>0;){var d=c.pop();if(null!=d&&!1!==d)if(Array.isArray(d))for(var h=0;h<d.length;h++)c.push(d[h]);else{var u=null!=t?t(d):d;if(null!=u.$$css){var y="";if(null!=a&&a.has(u)){var f=a.get(u);null!=f&&(y=f[0],l=f[2],r.push.apply(r,f[1]),a=f[3])}else{var m=[];for(var g in u){var x=u[g];if("$$css"!==g)"string"==typeof x||null===x?r.includes(g)||(r.push(g),null!=a&&m.push(g),"string"==typeof x&&(y+=y?" "+x:x)):console.error("styleq: ".concat(g," typeof ").concat(String(x),' is not "string" or "null".'));else{var j=u[g];!0!==j&&(l=l?j+"; "+l:j)}}if(null!=a){var b=new WeakMap;a.set(u,[y,m,l,b]),a=b}}y&&(o=o?y+" "+o:y)}else if(s)null==i&&(i={}),i=Object.assign({},u,i);else{var w=null;for(var v in u){var k=u[v];void 0!==k&&(r.includes(v)||(null!=k&&(null==i&&(i={}),null==w&&(w={}),w[v]=k),r.push(v),a=null))}null!=w&&(i=Object.assign(w,i))}}}return[o,i,l]}}return(t.styleq=r()).factory=r,t}();const i=e=>new Error(`Unexpected 'stylex.${e}' call at runtime. Styles must be compiled by '@stylexjs/babel-plugin'.`),l=e=>i(`types.${e}`);function a(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];const[s,t,i]=o.styleq(r),l={};return null!=s&&""!==s&&(l.className=s),null!=t&&Object.keys(t).length>0&&(l.style=t),null!=i&&""!==i&&(l["data-style-src"]=i),l}const c={angle:e=>{throw l("angle")},color:e=>{throw l("color")},url:e=>{throw l("url")},image:e=>{throw l("image")},integer:e=>{throw l("integer")},lengthPercentage:e=>{throw l("lengthPercentage")},length:e=>{throw l("length")},percentage:e=>{throw l("percentage")},number:e=>{throw l("number")},resolution:e=>{throw l("resolution")},time:e=>{throw l("time")},transformFunction:e=>{throw l("transformFunction")},transformList:e=>{throw l("transformList")}};function p(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];const[s]=o.styleq(r);return s}p.attrs=function(){const{className:e,"data-style-src":r,style:n}=a(...arguments),s={};return null!=e&&""!==e&&(s.class=e),null!=n&&Object.keys(n).length>0&&(s.style=Object.keys(n).map((e=>`${e}:${n[e]};`)).join("")),null!=r&&""!==r&&(s["data-style-src"]=r),s},p.create=function(e){throw i("create")},p.createTheme=(e,r)=>{throw i("createTheme")},p.defineVars=function(e){throw i("defineVars")},p.firstThatWorks=function(){throw i("firstThatWorks")},p.keyframes=e=>{throw i("keyframes")},p.props=a,p.types=c},35363:(e,r,n)=>{n.d(r,{A:()=>o});n(96540);var s=n(9136),t=n(74848);function o(e){let{children:r,fallback:n}=e;return(0,s.default)()?(0,t.jsx)(t.Fragment,{children:r?.()}):n??null}}}]);